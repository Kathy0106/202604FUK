<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ä¹å·è‡ªé§•éŠ 2025 (V29.1)</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <link href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@400;500;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Zen Maru Gothic', sans-serif;
            background-color: #E0F2F1; /* æ·ºæº«æ³‰ç¶  */
            overscroll-behavior-y: none;
        }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        .soft-shadow { box-shadow: 0 4px 20px rgba(0, 137, 123, 0.15); }
    </style>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        onsen: {
                            100: '#E0F2F1', 
                            200: '#B2DFDB', 
                            300: '#80CBC4',
                            500: '#26A69A', 
                            600: '#00897B', 
                            700: '#004D40',
                        }
                    }
                }
            }
        }
    </script>
</head>
<body class="text-slate-700 h-screen w-screen overflow-hidden flex flex-col">

    <div id="app" class="h-full flex flex-col relative">

        <div class="relative h-[250px] flex-shrink-0 bg-cover bg-center transition-all duration-500"
             style="background-image: url('./header.png'), url('./header.jpg');">
            <div class="absolute inset-0 bg-gradient-to-b from-transparent to-black/50"></div>
            
            <div class="absolute bottom-8 right-4 flex space-x-3 z-20">
                <button @click="currentTab = 'itinerary'" :class="tabClass('itinerary')"><i class="fa-solid fa-map-location-dot text-lg"></i></button>
                <button @click="currentTab = 'info'" :class="tabClass('info')"><i class="fa-solid fa-circle-info text-lg"></i></button>
                <button @click="currentTab = 'shopping'" :class="tabClass('shopping')"><i class="fa-solid fa-basket-shopping text-lg"></i></button>
                <button @click="currentTab = 'expenses'" :class="tabClass('expenses')"><i class="fa-solid fa-yen-sign text-lg"></i></button>
            </div>
            
            <div class="absolute bottom-10 left-6 text-white text-shadow drop-shadow-md">
                <h1 class="text-2xl font-bold tracking-widest">KYUSHU 2025</h1>
                <p class="text-sm opacity-90"><i class="fa-solid fa-car mr-1"></i>V29.1 æœ€çµ‚ä¿®æ­£ç‰ˆ</p>
            </div>
        </div>

        <div class="flex-1 bg-onsen-100 rounded-t-[30px] -mt-6 relative z-10 overflow-hidden flex flex-col shadow-[0_-5px_20px_rgba(0,0,0,0.1)]">
            <div class="flex-1 overflow-y-auto no-scrollbar p-5 pb-24">

                <div v-if="currentTab === 'itinerary'">
                    <div class="flex space-x-3 overflow-x-auto no-scrollbar mb-6 py-2">
                        <div v-for="(day, index) in days" :key="index" @click="selectedDayIndex = index"
                             class="flex-shrink-0 flex flex-col items-center justify-center w-16 h-20 rounded-2xl transition-all duration-300 snap-center cursor-pointer border border-white/50"
                             :class="selectedDayIndex === index ? 'bg-onsen-600 text-white shadow-lg scale-105' : 'bg-white text-gray-400'">
                            <span class="text-xs font-bold uppercase">{{ day.weekday }}</span>
                            <span class="text-xl font-bold">{{ day.date }}</span>
                            <span class="text-[10px] opacity-80">Day {{ index + 1 }}</span>
                        </div>
                    </div>

                    <div class="bg-gradient-to-r from-teal-100 to-onsen-200 rounded-2xl p-4 mb-12 flex items-center justify-between shadow-sm text-slate-700">
                        <div>
                            <div class="text-xs opacity-70 flex items-center gap-1"><i class="fa-solid fa-location-dot"></i> {{ weather.city_name }}</div>
                            <div class="text-2xl font-bold">{{ weather.temp }}Â°C <span class="text-sm font-normal text-gray-500">é«”æ„Ÿ {{ weather.feels_like }}Â°C</span></div>
                        </div>
                        <i :class="['fa-solid', weather.icon, 'text-4xl text-yellow-500 drop-shadow-sm']"></i>
                    </div>

                    <div class="space-y-0 relative">
                        <div class="absolute left-[22px] top-4 bottom-4 w-0.5 bg-onsen-300 opacity-50 z-0"></div>

                        <div v-for="(item, idx) in currentDayItinerary" :key="item.id" class="relative pl-12 pb-14 group">
                            <div v-if="idx > 0" class="absolute -top-9 left-12 right-0 flex items-center text-xs text-onsen-600 mb-2 z-50">
                                <span class="bg-onsen-100 px-3 py-1 rounded-full border border-onsen-200 flex items-center gap-1 shadow-sm font-bold whitespace-nowrap">
                                    <i :class="getTransportIcon(item.transportType)"></i>
                                    {{ item.travelTime || 'ç§»å‹•' }}
                                </span>
                            </div>
                            <div class="absolute left-0 top-4 w-11 h-11 rounded-full bg-white border-4 border-onsen-100 flex items-center justify-center z-10 shadow-sm text-onsen-600 font-bold text-xs">
                                {{ item.time.split(':')[0] }}
                            </div>
                            <div class="bg-white rounded-2xl p-4 soft-shadow relative overflow-hidden transition-all active:scale-95"
                                 :class="{'border-l-4 border-orange-300': item.category === 'flight', 'border-l-4 border-onsen-500': item.category !== 'flight'}">
                                <div @click="openMap(item.location)">
                                    <div class="flex justify-between items-start mb-1">
                                        <div class="text-xs font-bold text-onsen-600 uppercase tracking-wider">{{ item.time }} â€¢ {{ itemCategoryName(item.category) }}</div>
                                        <div class="flex gap-2">
                                            <button @click.stop="moveItem(idx, -1)" v-if="idx > 0" class="text-gray-300 hover:text-onsen-600"><i class="fa-solid fa-chevron-up"></i></button>
                                            <button @click.stop="moveItem(idx, 1)" v-if="idx < currentDayItinerary.length - 1" class="text-gray-300 hover:text-onsen-600"><i class="fa-solid fa-chevron-down"></i></button>
                                            <button @click.stop="deleteItem(item.id)" class="text-gray-300 hover:text-red-400"><i class="fa-solid fa-trash"></i></button>
                                        </div>
                                    </div>
                                    <h3 class="text-lg font-bold mb-1 leading-tight text-slate-800">{{ item.title }}</h3>
                                    <div class="text-sm text-gray-500 mb-2 flex items-start gap-1" v-if="item.desc">
                                        <i class="fa-regular fa-note-sticky mt-0.5 text-xs flex-shrink-0 text-onsen-500"></i>
                                        <span class="whitespace-pre-line text-xs">{{ item.desc }}</span>
                                    </div>
                                    
                                    <div v-if="item.parking" class="mt-2 p-2 bg-blue-50 rounded-lg text-xs text-blue-700 border border-blue-100 flex items-start gap-2">
                                        <i class="fa-solid fa-square-parking mt-0.5 flex-shrink-0"></i>
                                        <span class="whitespace-pre-line">{{ item.parking }}</span>
                                    </div>

                                    <div v-if="item.dadAction" class="mt-2 p-3 bg-red-50 rounded-xl text-xs text-red-600 border border-red-100 flex items-start gap-2 shadow-sm">
                                        <div class="bg-red-200 text-red-700 w-5 h-5 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5"><i class="fa-solid fa-person-cane text-[10px]"></i></div>
                                        <div>
                                            <strong class="block mb-0.5 text-red-700">çˆ¸çˆ¸è¡Œå‹• / é‡é»</strong>
                                            <span class="leading-relaxed whitespace-pre-line">{{ item.dadAction }}</span>
                                        </div>
                                    </div>
                                    
                                    <div class="flex flex-wrap gap-2 mt-2">
                                        <span v-if="item.desc && item.desc.includes('ç—›é¢¨')" class="text-[10px] bg-red-50 text-red-500 px-2 py-1 rounded-md font-bold border border-red-100">
                                            <i class="fa-solid fa-triangle-exclamation mr-1"></i>ç—›é¢¨æ³¨æ„
                                        </span>
                                        <span v-if="item.transportType === 'car'" class="text-[10px] bg-blue-50 text-blue-500 px-2 py-1 rounded-md"><i class="fa-solid fa-car mr-1"></i>è‡ªé§•</span>
                                        <span v-if="item.location" class="text-[10px] bg-gray-100 text-gray-500 px-2 py-1 rounded-md"><i class="fa-solid fa-location-arrow mr-1"></i>å°èˆª</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div v-if="currentDayItinerary.length === 0" class="text-center text-gray-400 py-10">
                            <i class="fa-solid fa-calendar-plus text-4xl mb-3 text-onsen-200"></i>
                            <p>é»æ“Šå³ä¸‹è§’æ–°å¢è¡Œç¨‹</p>
                        </div>
                    </div>
                </div>

                <div v-if="currentTab === 'info'" class="space-y-6">
                    
                    <div class="bg-red-50 rounded-2xl p-4 border border-red-100 text-red-800 shadow-sm">
                        <div class="font-bold mb-2 flex items-center"><i class="fa-solid fa-bullseye mr-2"></i>æ ¸å¿ƒæˆ°è¡“</div>
                        <p class="text-sm font-bold">é–€å£è½å®¢ ğŸš™ â” é•·è¼©åä½ä¼‘æ¯ â˜• â” å§‘ä¸ˆå»æ³Šè»Š ğŸ…¿ï¸</p>
                        <div class="mt-2 text-xs opacity-90 border-t border-red-200 pt-2">
                            <p><strong>è»Šæ‰‹ï¼š</strong>çˆ¸çˆ¸ & å§‘ä¸ˆ (è¼ªæµæ¸)</p>
                            <p><strong>åª½åª½SOPï¼š</strong>æ¯æ—¥ 07:00 é…’åº—æˆ¿é£Ÿé¦™è•‰/è›‹ç³•å¢Šåº•ï¼</p>
                        </div>
                    </div>

                    <div class="bg-white rounded-2xl p-0 soft-shadow overflow-hidden border-2 border-red-100">
                        <div class="bg-red-50 p-3 text-red-600 font-bold flex justify-between items-center">
                            <span><i class="fa-regular fa-bell mr-2"></i>To-Book æ¶è¨‚é¬§é˜ (4æœˆè¡Œ)</span>
                            <span class="text-xs bg-red-200 px-2 py-1 rounded-full text-red-800">å¿…åš</span>
                        </div>
                        <div class="p-4 space-y-4 text-sm">
                            <div>
                                <h4 class="font-bold text-red-600 mb-2 border-b border-red-100 pb-1">ğŸš¨ Level 1: å³åˆ»åš (Immediate)</h4>
                                <ul class="space-y-2 text-xs text-gray-600">
                                    <li><span class="font-bold text-slate-800">ğŸ¨ é»‘å· æ·±å±±å±±èŠ:</span> <span class="text-red-500">Deadline: Now!</span><br><span class="bg-gray-100 p-1 rounded select-all block mt-1">"One guest cannot eat seafood and offal. Please arrange beef or pork. Need Golf Cart service for elderly."</span></li>
                                    <li><span class="font-bold text-slate-800">ğŸš˜ ç§Ÿè»Š (Noah/Alphard):</span> <span class="text-red-500">1æœˆå°¾å‰</span><br>è¨˜å¾—å‰” ETC & NOC å…¨ä¿ã€‚</li>
                                </ul>
                            </div>
                            <div>
                                <h4 class="font-bold text-orange-500 mb-2 border-b border-orange-100 pb-1">âš ï¸ Level 2: 3æœˆåˆ (1å€‹æœˆå‰)</h4>
                                <ul class="space-y-2 text-xs text-gray-600">
                                    <li><span class="font-bold text-slate-800">ğŸ¢ ç‡’é³¥ Torine:</span> 3æœˆ9æ—¥ (è«‹é…’åº—å¹«æ‰‹æ‰“é›»è©±)</li>
                                    <li><span class="font-bold text-slate-800">ğŸš‚ é«˜åƒç©—å°ç«è»Š:</span> 3æœˆ11æ—¥ (00:00 æ—¥æœ¬æ™‚é–“é–‹æ¶)</li>
                                    <li><span class="font-bold text-slate-800">ğŸ² è¯å‘³é³¥ (å¤©ç¥):</span> 3æœˆ12æ—¥ (å®˜ç¶²è¨‚ Table Seat)</li>
                                    <li><span class="font-bold text-slate-800">ğŸ¥© ä½è³€ç‰› å­£æ¨‚:</span> 3æœˆ13æ—¥ (TableCheck)</li>
                                </ul>
                            </div>
                            <div>
                                <h4 class="font-bold text-blue-500 mb-2 border-b border-blue-100 pb-1">ğŸ› ï¸ Level 3: 3æœˆå°¾ (2æ˜ŸæœŸå‰)</h4>
                                <ul class="space-y-2 text-xs text-gray-600">
                                    <li><span class="font-bold text-slate-800">ğŸªª åœ‹éš›è»Šç‰Œ (IDP):</span> 3æœˆ25æ—¥ (çˆ¸çˆ¸+å§‘ä¸ˆ)</li>
                                    <li><span class="font-bold text-slate-800">ğŸ“¶ SIM å¡ (6å¼µ):</span> 3æœˆ25æ—¥ (æ¯äººä¸€å¼µ)</li>
                                    <li><span class="font-bold text-slate-800">â™¿ è¼ªæ¤…æœå‹™:</span> 4æœˆ2æ—¥ (è‡´é›» CX ç¢ºèª)</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white rounded-2xl p-4 soft-shadow">
                        <h3 class="font-bold text-gray-600 mb-3"><i class="fa-solid fa-clipboard-check mr-2"></i>å‡ºç™¼å‰ Checklist (V28)</h3>
                        <div class="space-y-2 text-sm">
                            <div class="flex items-center gap-2"><input type="checkbox" class="accent-onsen-600"> è­·ç…§ (4æœ¬) ğŸ“•</div>
                            <div class="flex items-center gap-2"><input type="checkbox" class="accent-onsen-600"> åœ‹éš›è»Šç‰Œ (çˆ¸çˆ¸+å§‘ä¸ˆ) ğŸªª</div>
                            <div class="flex items-center gap-2"><input type="checkbox" class="accent-onsen-600"> é¦™æ¸¯è»Šç‰Œæ­£æœ¬ (çˆ¸çˆ¸+å§‘ä¸ˆ) ğŸªª</div>
                            <div class="flex items-center gap-2"><input type="checkbox" class="accent-onsen-600"> å¸¸ç”¨è—¥ç‰© (ç—›é¢¨/è¡€å£“) ğŸ’Š</div>
                            <div class="flex items-center gap-2"><input type="checkbox" class="accent-onsen-600"> æ—¥æœ¬ä¸Šç¶²å¡ ğŸ“¶</div>
                            <div class="flex items-center gap-2"><input type="checkbox" class="accent-onsen-600"> ETC å¡ (å–è»Šæ™‚ç¢ºèª) ğŸ’³</div>
                        </div>
                    </div>

                    <div class="bg-white rounded-2xl p-0 soft-shadow overflow-hidden border-l-4 border-blue-500">
                        <div class="bg-blue-50 p-3 text-blue-700 font-bold flex justify-between">
                            <span><i class="fa-solid fa-car-side mr-2"></i>ç¦å²¡æ©Ÿå ´å–è»Šãƒ»é˜²è¡ŒéŒ¯</span>
                        </div>
                        <div class="p-4 text-sm space-y-3">
                            <div class="flex gap-3">
                                <div class="bg-blue-100 text-blue-600 w-6 h-6 rounded-full flex items-center justify-center flex-shrink-0 font-bold">1</div>
                                <div><strong class="block text-slate-700">1 æ¨“æ«ƒæª¯æ‰‹çºŒ</strong>æŠµé”å¤§å»³æµç§Ÿè»Šæ«ƒæª¯ã€‚å¦‚ç„¡äººï¼Œç”¨æ«ƒæª¯é›»è©±æ’³æ£ã€‚</div>
                            </div>
                            <div class="flex gap-3">
                                <div class="bg-blue-100 text-blue-600 w-6 h-6 rounded-full flex items-center justify-center flex-shrink-0 font-bold">2</div>
                                <div><strong class="block text-slate-700">ä¸Š 3 æ¨“ (é‡é»!)</strong>æ­ <span class="text-red-500 font-bold">é›»æ¢¯ (Elevator)</span> ä¸Š 3 æ¨“å‡ºå¢ƒå±¤ã€‚</div>
                            </div>
                            <div class="flex gap-3">
                                <div class="bg-blue-100 text-blue-600 w-6 h-6 rounded-full flex items-center justify-center flex-shrink-0 font-bold">3</div>
                                <div><strong class="block text-slate-700">å‡ºé–€å£ç­‰è»Š</strong>å‡º 3 æ¨“å¤§é–€ï¼Œéå°é¦¬è·¯å»ã€Œä¸­æ´²ã€ç­‰ Shuttle Busã€‚</div>
                            </div>
                            <div class="flex gap-3">
                                <div class="bg-blue-100 text-blue-600 w-6 h-6 rounded-full flex items-center justify-center flex-shrink-0 font-bold">4</div>
                                <div><strong class="block text-slate-700">é©—è»Š</strong>å§‘ä¸ˆåŒçˆ¸çˆ¸è² è²¬åœä½éƒ¨è»Šæ‹ç‰‡éŒ„å½± ğŸ“¹ã€‚</div>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white rounded-2xl p-5 soft-shadow">
                        <h3 class="font-bold text-onsen-600 mb-3"><i class="fa-solid fa-coins mr-2"></i>åŒ¯ç‡æ›ç®—</h3>
                        <div class="flex items-center gap-2 mb-2">
                            <div class="flex-1 bg-gray-50 rounded-lg p-2 flex items-center"><span class="text-gray-400 mr-2 text-sm">JPY</span><input type="number" v-model="calcJpy" @input="convert('jpy')" class="w-full bg-transparent outline-none font-bold text-lg" placeholder="0"></div>
                            <i class="fa-solid fa-arrow-right-arrow-left text-gray-300"></i>
                            <div class="flex-1 bg-gray-50 rounded-lg p-2 flex items-center"><span class="text-gray-400 mr-2 text-sm">HKD</span><input type="number" v-model="calcHkd" @input="convert('hkd')" class="w-full bg-transparent outline-none font-bold text-lg" placeholder="0"></div>
                        </div>
                        <div class="text-right text-xs text-gray-400">åŒ¯ç‡: {{ exchangeRate }} (JPY -> HKD)</div>
                    </div>

                    <div class="bg-white rounded-2xl p-0 soft-shadow overflow-hidden">
                        <div class="bg-gray-100 p-3 text-gray-600 font-bold flex justify-between"><span><i class="fa-solid fa-plane mr-2"></i>èˆªç­è³‡è¨Š (CX)</span></div>
                        <div class="p-5">
                            <div class="mb-4">
                                <div class="flex justify-between text-xs text-gray-400 mb-1"><span>4/9 å»ç¨‹ (HKG â†’ FUK)</span></div>
                                <div class="flex justify-between items-center mb-1">
                                    <div class="text-2xl font-bold text-slate-700">11:00</div>
                                    <div class="h-0.5 w-10 bg-gray-200 relative flex justify-center"><i class="fa-solid fa-plane text-onsen-500 absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"></i></div>
                                    <div class="text-2xl font-bold text-slate-700">15:30</div>
                                </div>
                                <div class="flex justify-between text-sm font-bold bg-onsen-50 text-onsen-700 p-2 rounded-lg"><span>CX588</span><span>é¦™æ¸¯ â†’ ç¦å²¡</span></div>
                                <a href="https://www.google.com/search?q=CX588+flight+status" target="_blank" class="block w-full text-center py-2 rounded-lg border border-gray-300 text-gray-500 text-sm font-bold hover:bg-gray-50 transition-colors mt-2"><i class="fa-solid fa-wifi mr-1"></i> æŸ¥çœ‹å³æ™‚ç‹€æ…‹</a>
                            </div>
                            <div class="border-t border-dashed border-gray-200 my-4"></div>
                            <div>
                                <div class="flex justify-between text-xs text-gray-400 mb-1"><span>4/14 å›ç¨‹ (FUK â†’ HKG)</span></div>
                                <div class="flex justify-between items-center mb-1">
                                    <div class="text-2xl font-bold text-slate-700">16:40</div>
                                    <div class="h-0.5 w-10 bg-gray-200 relative flex justify-center"><i class="fa-solid fa-plane text-onsen-500 absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"></i></div>
                                    <div class="text-2xl font-bold text-slate-700">19:25</div>
                                </div>
                                <div class="flex justify-between text-sm font-bold bg-onsen-50 text-onsen-700 p-2 rounded-lg mb-2"><span>CX589</span><span>ç¦å²¡ â†’ é¦™æ¸¯</span></div>
                                <a href="https://www.google.com/search?q=CX589+flight+status" target="_blank" class="block w-full text-center py-2 rounded-lg border border-gray-300 text-gray-500 text-sm font-bold hover:bg-gray-50 transition-colors"><i class="fa-solid fa-wifi mr-1"></i> æŸ¥çœ‹å³æ™‚ç‹€æ…‹</a>
                            </div>
                        </div>
                    </div>

                    <div class="space-y-4">
                        <h3 class="font-bold text-gray-500 ml-1">ä½å®¿åˆ—è¡¨</h3>
                        <div v-for="hotel in hotels" :key="hotel.name" class="bg-white rounded-2xl p-4 soft-shadow flex items-center gap-4" @click="openMap(hotel.name)">
                            <div class="w-12 h-12 rounded-full bg-onsen-200 flex items-center justify-center text-onsen-700 text-xl"><i class="fa-solid fa-bed"></i></div>
                            <div class="flex-1">
                                <h4 class="font-bold text-sm">{{ hotel.name }}</h4>
                                <p class="text-xs text-gray-400 mt-1">{{ hotel.dates }}</p>
                                <p v-if="hotel.phone" class="text-xs text-blue-400 mt-0.5"><i class="fa-solid fa-phone mr-1"></i>{{ hotel.phone }}</p>
                            </div>
                            <i class="fa-solid fa-chevron-right text-gray-300"></i>
                        </div>
                    </div>
                </div>

                <div v-if="currentTab === 'shopping'">
                    <div class="grid grid-cols-2 gap-4">
                        <div v-for="item in shoppingList" :key="item.id" class="bg-white rounded-xl p-3 soft-shadow relative group">
                            <button @click="removeShoppingItem(item.id)" class="absolute top-2 right-2 bg-white/80 rounded-full w-6 h-6 flex items-center justify-center text-red-400 shadow-sm z-10"><i class="fa-solid fa-xmark"></i></button>
                            <div class="aspect-square bg-gray-100 rounded-lg mb-2 overflow-hidden bg-cover bg-center" :style="item.image ? `background-image: url(${item.image})` : ''">
                                 <div v-if="!item.image" class="w-full h-full flex items-center justify-center text-gray-300"><i class="fa-solid fa-image"></i></div>
                            </div>
                            <h4 class="font-bold text-sm text-center truncate">{{ item.name }}</h4>
                        </div>
                    </div>
                    <div v-if="shoppingList.length === 0" class="text-center text-gray-400 mt-10"><p>å°šç„¡è³¼ç‰©æ¸…å–®</p><p class="text-xs mt-2">è¨˜å¾—è²·åŠªåŠªé›ï¼</p></div>
                </div>

                <div v-if="currentTab === 'expenses'">
                    <div class="bg-onsen-600 text-white rounded-2xl p-6 mb-6 shadow-lg text-center">
                        <div class="text-sm opacity-80 mb-1">ç¸½èŠ±è²» (æ—¥å…ƒ)</div>
                        <div class="text-4xl font-bold">Â¥{{ totalExpenses.toLocaleString() }}</div>
                        <div class="text-xs opacity-70 mt-1">â‰ˆ HK$ {{ (totalExpenses * exchangeRate).toFixed(1) }}</div>
                    </div>
                    <div class="space-y-3">
                        <div v-for="exp in expenses" :key="exp.id" class="bg-white rounded-xl p-4 soft-shadow flex justify-between items-center relative group">
                            <button @click="deleteExpense(exp.id)" class="absolute top-2 right-3 text-gray-300 hover:text-red-400 p-2 z-10"><i class="fa-solid fa-trash-can"></i></button>
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center text-gray-500"><i :class="getCategoryIcon(exp.category)"></i></div>
                                <div><div class="font-bold text-sm">{{ exp.name }}</div><div class="text-xs text-gray-400">{{ exp.date }} â€¢ {{ exp.payment }}</div></div>
                            </div>
                            <div class="text-right pr-6">
                                <div class="font-bold text-onsen-600">Â¥{{ parseInt(exp.amount).toLocaleString() }}</div>
                                <div class="text-[10px] text-gray-300">â‰ˆ HK$ {{ (exp.amount * exchangeRate).toFixed(0) }}</div>
                            </div>
                        </div>
                    </div>
                    <div v-if="expenses.length === 0" class="text-center text-gray-400 mt-10"><p>å°šæœªæœ‰è¨˜å¸³</p></div>
                </div>
            </div>
        </div>

        <button @click="openAddModal" class="absolute bottom-6 right-6 w-14 h-14 bg-onsen-600 text-white rounded-full shadow-lg flex items-center justify-center text-2xl z-50 hover:bg-onsen-500 transition-colors"><i class="fa-solid fa-plus"></i></button>

        <div v-if="showModal" class="fixed inset-0 z-50 flex items-end sm:items-center justify-center bg-black/50 backdrop-blur-sm" @click.self="showModal = false">
            <div class="bg-white w-full sm:w-96 rounded-t-3xl sm:rounded-3xl p-6 shadow-2xl animate-slide-up">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-xl font-bold text-onsen-600">{{ currentTab === 'itinerary' ? 'æ–°å¢è¡Œç¨‹' : currentTab === 'shopping' ? 'æ–°å¢è³¼ç‰©' : 'è¨˜ä¸€ç­†' }}</h3>
                    <button @click="showModal = false" class="text-gray-400"><i class="fa-solid fa-xmark text-xl"></i></button>
                </div>

                <div v-if="currentTab === 'itinerary'" class="space-y-4">
                    <input v-model="newItem.title" type="text" placeholder="è¡Œç¨‹åç¨±" class="w-full p-3 bg-gray-50 rounded-xl border-none outline-none focus:ring-2 focus:ring-onsen-300">
                    <div class="flex gap-2">
                        <input v-model="newItem.time" type="time" class="w-1/3 p-3 bg-gray-50 rounded-xl outline-none">
                        <select v-model="newItem.category" class="w-2/3 p-3 bg-gray-50 rounded-xl outline-none"><option value="sightseeing">æ™¯é»</option><option value="food">ç¾é£Ÿ</option><option value="shopping">è³¼ç‰©</option><option value="transport">äº¤é€š</option><option value="hotel">ä½å®¿</option></select>
                    </div>
                    <div class="bg-gray-50 p-3 rounded-xl">
                         <div class="flex gap-2">
                             <select v-model="newItem.transportType" class="flex-1 p-2 bg-white rounded-lg text-sm"><option value="car">è‡ªé§•</option><option value="walk">æ­¥è¡Œ</option><option value="train">JR/éµè·¯</option></select>
                             <input v-model="newItem.travelTime" placeholder="æ™‚é–“ (e.g. 1.5 hr)" class="flex-1 p-2 bg-white rounded-lg text-sm">
                         </div>
                     </div>
                    <textarea v-model="newItem.desc" placeholder="é›»è©± / Mapcode / å‚™è¨»" class="w-full p-3 bg-gray-50 rounded-xl border-none outline-none h-24"></textarea>
                    <input v-model="newItem.dadAction" type="text" placeholder="ğŸ›‘ çˆ¸çˆ¸è¡Œå‹• (é¸å¡«)" class="w-full p-3 bg-red-50 text-red-600 rounded-xl border border-red-100 outline-none text-sm placeholder-red-300">
                    <input v-model="newItem.location" type="text" placeholder="å°èˆªåœ°é» (Google Map)" class="w-full p-3 bg-gray-50 rounded-xl border-none outline-none text-sm">
                </div>

                <div v-if="currentTab === 'shopping'" class="space-y-4">
                    <input v-model="newShopping.name" type="text" placeholder="å•†å“åç¨±" class="w-full p-3 bg-gray-50 rounded-xl outline-none">
                    <div class="relative w-full h-32 bg-gray-50 rounded-xl border-2 border-dashed border-gray-200 flex flex-col items-center justify-center text-gray-400 cursor-pointer hover:bg-gray-100">
                        <input type="file" @change="handleImageUpload" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer">
                        <i class="fa-solid fa-camera text-2xl mb-1"></i>
                    </div>
                </div>

                <div v-if="currentTab === 'expenses'" class="space-y-4">
                    <input v-model="newExpense.name" type="text" placeholder="é …ç›®åç¨±" class="w-full p-3 bg-gray-50 rounded-xl outline-none">
                    <div class="flex gap-2">
                        <input v-model="newExpense.amount" type="number" placeholder="é‡‘é¡ (JPY)" class="flex-1 p-3 bg-gray-50 rounded-xl outline-none">
                        <select v-model="newExpense.category" class="w-1/3 p-3 bg-gray-50 rounded-xl outline-none"><option value="food">é£²é£Ÿ</option><option value="transport">äº¤é€š/æ²¹</option><option value="shopping">è³¼ç‰©</option><option value="ticket">é–€ç¥¨</option><option value="hotel">ä½å®¿</option></select>
                    </div>
                     <select v-model="newExpense.payment" class="w-full p-3 bg-gray-50 rounded-xl outline-none"><option value="ç¾é‡‘">ç¾é‡‘</option><option value="ä¿¡ç”¨å¡">ä¿¡ç”¨å¡</option><option value="IC Card">IC Card</option></select>
                </div>

                <button @click="confirmAdd" class="w-full bg-onsen-600 text-white font-bold py-4 rounded-xl mt-6 shadow-lg hover:bg-onsen-500 transition-all">ç¢ºèªæ–°å¢</button>
            </div>
        </div>
    </div>

    <script>
        const { createApp } = Vue;

        createApp({
            data() {
                return {
                    currentTab: 'itinerary',
                    selectedDayIndex: 0,
                    showModal: false,
                    exchangeRate: 0.053,
                    calcJpy: '',
                    calcHkd: '',
                    
                    weather: { city_name: 'åˆ¥åºœ, æ—¥æœ¬', temp: '--', feels_like: '--', icon: 'fa-spinner fa-spin' },
                    apiKey: 'cc2dab2806da14aec6dab2ed8260a1c4', 

                    days: [
                        { weekday: 'Wed', date: '4/9' }, { weekday: 'Thu', date: '4/10' }, { weekday: 'Fri', date: '4/11' },
                        { weekday: 'Sat', date: '4/12' }, { weekday: 'Sun', date: '4/13' }, { weekday: 'Mon', date: '4/14' }
                    ],

                    hotels: [
                        { name: 'å¾¡å®¿ é‡ä¹ƒåˆ¥åºœ', dates: '4/9', phone: '0977-21-5489' },
                        { name: 'é»’å·æ¸©æ³‰ æ·±å±±å±±è˜', dates: '4/10', phone: '0967-44-0553' },
                        { name: 'å¾¡å®¿ é‡ä¹ƒç†Šæœ¬', dates: '4/11', phone: '096-311-5489' },
                        { name: 'Hotel JAL City Fukuoka Tenjin', dates: '4/12 - 4/14', phone: '092-712-7575' }
                    ],

                    itineraryData: [
                        // Day 1: 4/9 ç¦å²¡ -> åˆ¥åºœ
                        [
                            { id: 1, time: '15:30', title: 'æŠµé”ç¦å²¡æ©Ÿå ´ (CX588)', category: 'flight', desc: '1. åˆ°1Fæ«ƒæª¯è¾¦æ‰‹çºŒ\n2. ä¸Š3Fé–€å£æ­æ¥é§è»Š\n3. å–è»Š Noah/Alphard', transportType: 'car', location: 'ç¦å²¡æ©Ÿå ´åœ‹éš›ç·š' },
                            { id: 2, time: '17:00', title: 'å‡ºç™¼å¾€åˆ¥åºœ', category: 'transport', desc: 'çˆ¸çˆ¸é–‹ ACC è¼•é¬†æ¸\nè¡Œç¨‹: 144km (ç´„ 1å°æ™‚55åˆ†)', transportType: 'car', travelTime: 'å–è»Š (1.5hr)' },
                            { id: 3, time: '19:30', title: 'æ™šé¤: ç‡’é³¥ Torine', category: 'food', desc: 'Tel: 0977-21-1666\nå«ä¸²ç‡’æ‹¼ç›¤ (å°‘å…§è‡Ÿ)', parking: 'æ³Šå°é¢/éš”ç±¬ Coin Parking', dadAction: 'è»Šé§›åˆ°é–€å£ã€‚çˆ¸çˆ¸åª½åª½è½è»Šå…¥å»åã€‚å§‘ä¸ˆå»æ³Šè»Šã€‚', transportType: 'car', location: 'ç„¼ãé³¥ é³¥ãƒ', travelTime: '144km (ç´„2å°æ™‚)' },
                            { id: 4, time: '21:00', title: 'Check-in å¾¡å®¿é‡ä¹ƒ', category: 'hotel', desc: 'Tel: 0977-21-5489', parking: 'é…’åº— Tower Parking (æˆ–ç‰¹ç´„å ´)', dadAction: 'é–€å£è½å®¢ä½å¥½é—Šï¼Œæ”¾ä½è¡Œæã€‚å…¨é¤¨å¡Œå¡Œç±³ï¼Œå…¥å¤§å ‚è¦é™¤é‹ã€‚', transportType: 'car', location: 'å¾¡å®¿ é‡ä¹ƒåˆ¥åºœ', travelTime: '0.4km (2åˆ†é˜)' }
                        ],
                        // Day 2: 4/10 åˆ¥åºœ -> é»‘å·
                        [
                            { id: 21, time: '08:30', title: 'æ—©é¤: å²¡æœ¬å±‹', category: 'food', desc: 'Tel: 0977-66-3228\nå¿…é£Ÿ: åœ°ç„è’¸å¸ƒç”¸ / æº«æ³‰è›‹ä¸‰æ–‡æ²»', parking: 'åº—èˆ–å°é¢æœ‰å°ˆç”¨å…è²»ç©ºåœ°', dadAction: 'é–€å£è½å®¢ï¼Œçˆ¸çˆ¸å…¥å»æµä½ã€‚', transportType: 'car', location: 'å²¡æœ¬å±‹ å£²åº—', travelTime: '8.1km (20åˆ†é˜)' },
                            { id: 22, time: '10:00', title: 'æµ·åœ°ç„', category: 'sightseeing', desc: 'Tel: 0977-66-0121\nç‡è—è‰²æº«æ³‰æ± ', parking: 'é–€å£æœ‰è¶…å¤§å…è²»åœè»Šå ´', dadAction: 'å”®ç¥¨è™•é–€å£è½å®¢ï¼Œå¹³è·¯ã€‚', transportType: 'walk', location: 'æµ·åœ°ç„', travelTime: '2.8km (7åˆ†é˜)' },
                            { id: 23, time: '10:45', title: 'åˆé¤: åœ°ç„è’¸å·¥æˆ¿ éµè¼ª', category: 'food', desc: 'Tel: 0977-66-3775\nè‡ªå·±è’¸é‡é£Ÿ', parking: 'å°èˆªå»ã€Œé‰„è¼ªæ¸©æ³‰åœ°åŒºé§è»Šå ´ã€(46 521 268*52)', dadAction: 'çˆ¸çˆ¸å…¥å»æµä½åã€‚å§‘ä¸ˆ/å§‘å§å»è²·é£Ÿåˆ¸åŒæ”é£Ÿæã€‚', transportType: 'walk', location: 'åœ°ç„è’¸ã—å·¥æˆ¿ é‰„è¼ª', travelTime: '0.9km (5åˆ†é˜)' },
                            { id: 24, time: '13:00', title: 'ç”±å¸ƒé™¢ é‡‘é±—æ¹–', category: 'sightseeing', desc: 'å°èˆª: å¤©ç¥–ç¥ç¤¾ (269 359 555*55)', parking: 'ä¸€å®šè¦æ³Šå‘¢å€‹å ´!', dadAction: 'è½è»Šè¡Œ 10 æ­¥å°±ä¿‚æ¹–é‚Šã€‚\nğŸ¶ å§‘å§ä»»å‹™: è¡Œå» Snoopy èŒ¶å±‹æƒè²¨ï¼Œçˆ¸çˆ¸åœ¨æ¹–é‚Š/Cafeç­‰ã€‚', transportType: 'car', location: 'é‡‘é±—æ¹–', travelTime: '20.6km (35åˆ†é˜)' },
                            { id: 25, time: '16:30', title: 'Check-in æ·±å±±å±±èŠ', category: 'hotel', desc: 'Tel: 0967-44-1101 / 0967-44-0336\nåœ°å€: ç†Šæœ¬çœŒé˜¿è˜‡éƒ¡å—å°å›½ç”ºæº€é¡˜å¯º6393', parking: 'ç›´æ¥é§›å…¥ Lobby é–€å£', dadAction: '1. è»Šé§›åˆ° Lobby é–€å£\n2. åŒè·å“¡è¬› "Golf Cart Please"\n3. åè»Šé€çˆ¸çˆ¸å»æˆ¿', transportType: 'car', location: 'é»’å·æ¸©æ³‰ æ·±å±±å±±è˜', travelTime: '51.6km (1å°æ™‚10åˆ†)' }
                        ],
                        // Day 3: 4/11 é»‘å· -> é«˜åƒç©— -> ç†Šæœ¬
                        [
                            { id: 31, time: '11:00', title: 'é«˜åƒç©—å³½ (çœŸåäº•ä¹‹ç€§)', category: 'sightseeing', desc: 'Tel: 0982-72-3216\nå…¨ç¨‹åå®šå®šç‡é¢¨æ™¯', parking: 'ç¬¬3å¤§æ©‹é§è»Šå ´ (P3) (330 711 700*55)', dadAction: '1. æ³Š P3 è»Šå ´\n2. è½‰ Shuttle Taxi (200å††) è½å³½è°·\n3. æ¨è¼ªæ¤…å»è§€æ™¯å°å½±ç›¸', transportType: 'car', location: 'é«˜åƒç©—å¤©ç…§éµé“', travelTime: '65.4km (1å°æ™‚20åˆ†)' },
                            { id: 32, time: '13:30', title: 'åˆé¤: ç´…ç‰›ä¸¼ (Gotoya)', category: 'food', desc: 'Tel: 0967-22-0266\né˜¿è˜‡ç¥ç¤¾é–€å‰ç”º', parking: 'é˜¿è˜‡ç¥ç¤¾ ç¬¬1é§è»Šå ´ (å…è²»)', dadAction: 'Plan B: çˆ¸çˆ¸å»é˜¿è˜‡ç¥ç¤¾åƒæ‹œ/ä¼‘æ¯ï¼Œå§‘å§æ’éšŠã€‚', transportType: 'car', location: 'Gotoya Aso', travelTime: '50km (1å°æ™‚)' },
                            { id: 33, time: '14:45', title: 'ç”œå“: ASO MILK FACTORY', category: 'food', desc: 'Tel: 0967-23-2110\né˜¿è˜‡ç‰›å¥¶å·¥å» ', parking: 'é–€å£æœ‰è¶…å¤§å…è²»å ´', dadAction: 'å…¥å®¤å…§åä½ã€‚å§‘å§è²·é›ªç³•ä¿¾çˆ¸çˆ¸é£Ÿã€‚å»åŸ‹æ´—æ‰‹é–“å…ˆä¸Šè»Šã€‚', transportType: 'car', location: 'ASO MILK FACTORY', travelTime: '6.4km (11åˆ†é˜)' },
                            { id: 34, time: '19:00', title: 'æ™šé¤: å‹çƒˆäº­ è±¬æ’', category: 'food', desc: 'Tel: 096-322-8771\næ–°å¸‚è¡—æœ¬åº—', parking: 'æ³Šè¾›å³¶å…¬åœ’åœ°ä¸‹åœè»Šå ´ (096-322-0024)', dadAction: 'æ³Šå¥½è»Šæ­é›»æ¢¯ä¸Šåœ°é¢ã€‚åœ°é¢è¡Œå»é¤å»³ä¿‚å¹³è·¯ã€‚', transportType: 'walk', location: 'å‹çƒˆäº­ æ–°å¸‚è¡—æœ¬åº—', travelTime: '45.8km (1å°æ™‚30åˆ†)' },
                            { id: 35, time: '21:00', title: 'Check-in å¾¡å®¿é‡ä¹ƒ', category: 'hotel', desc: 'Tel: 096-311-5489\nç†Šæœ¬å¸‚å…§', parking: 'é…’åº—å¾Œé–€ç«‹é«”å ´(çª„)ï¼Œæˆ–æ³Šè¿”è¾›å³¶å…¬åœ’åœ°ä¸‹å ´', dadAction: 'é–€å£è½å®¢ã€‚å…¨é¤¨å¡Œå¡Œç±³ï¼Œå…¥é–€è¦é™¤é‹ã€‚', transportType: 'car', location: 'å¾¡å®¿ é‡ä¹ƒç†Šæœ¬', travelTime: '0.5km (2åˆ†é˜)' }
                        ],
                        // Day 4: 4/12 æŸ³å· -> ç¦å²¡
                        [
                            { id: 41, time: '12:30', title: 'åˆé¤: æŸ³å·å¾¡èŠ± - å°æœˆé¤¨', category: 'food', desc: 'Tel: 0944-73-2189\nè’¸ç± é°»é­šé£¯ (ä¸åèˆ¹)', parking: 'å¾¡èŠ±æœ‰å°ˆç”¨å…è²»åœè»Šå ´', dadAction: 'åœè»Šå ´åœ¨æ­£é–€å°é¢ï¼Œå…¨ç¨‹å¹³è·¯ã€‚', transportType: 'car', location: 'æŸ³å·è—©ä¸»ç«‹èŠ±é‚¸ å¾¡èŠ±', travelTime: '61.3km (1å°æ™‚20åˆ†)' },
                            { id: 42, time: '15:30', title: 'å¤ªå®°åºœå¤©æ»¿å®®', category: 'sightseeing', desc: 'Mapcode: 55 364 013*77', parking: 'å¤§å®°åºœé§è»Šã‚»ãƒ³ã‚¿ãƒ¼ (ä½å¤šå¥½æ³Š)', dadAction: 'åƒé“å¥½é•·ã€‚çˆ¸çˆ¸è¡Œåˆ°ç¬¬ä¸€é–“ Starbucks å°±å…¥å»åä½é£²é‡ã€‚', transportType: 'car', location: 'å¤ªå®°åºœå¤©æ»¿å®®', travelTime: '63.5km (1å°æ™‚15åˆ†)' },
                            { id: 43, time: '18:00', title: 'Check-in JAL City å¤©ç¥', category: 'hotel', desc: 'Tel: 092-712-7575\nå°±åœ¨èµ¤å‚ç«™å‡ºå£æ—', dadAction: 'ã€æ³Šè»Šé¸é …ã€‘\nA. é…’åº—å ´ (Â¥2000/26ä½/çª„) âŒ\nB. ç´™ä¸å¤§å (Â¥100/60min) ğŸ‘\nC. å®‰å›½ (è¿‘) ğŸ‘Œ\nD. Times (å¾Œå‚™)', parking: '1. é§›å…¥é…’åº—æ­£é–€å½ä½è½å®¢\n2. å§‘ä¸ˆå»æ³Šè»Š (æ¨è–¦ Option B)', transportType: 'car', location: 'Hotel JAL City Fukuoka Tenjin', travelTime: '22.1km (40åˆ†é˜)' },
                            { id: 44, time: '19:30', title: 'æ™šé¤: åšå¤šè¯å‘³é³¥ å¤©ç¥åº—', category: 'food', desc: 'Tel: 092-733-6050\næ°´ç‚Šé›', parking: 'Times ç¦å²¡å¤©ç¥ (13 318 402*15)', dadAction: 'è»Šå…ˆé§›åˆ°é¤å»³é™„è¿‘å··å£æ”¾ä½çˆ¸çˆ¸ã€‚æ¹¯é«˜éˆ‰é£²ä¸€ç¢—å°±å¥½ã€‚', transportType: 'car', location: 'åšå¤šè¯å‘³é³¥ å¤©ç¥åº—', travelTime: '1.2km (10åˆ†é˜)' },
                            { id: 45, time: '21:30', title: 'å›é…’åº—ä¼‘æ¯', category: 'hotel', desc: 'Hotel JAL City', transportType: 'car', location: 'Hotel JAL City Fukuoka Tenjin', travelTime: '1.2km (10åˆ†é˜)' }
                        ],
                         // Day 5: 4/13 ç¦å²¡å¸‚å€
                         [
                            { id: 51, time: '12:00', title: 'åˆé¤: ä½è³€ç‰› å­£æ¨‚', category: 'food', desc: 'Tel: 092-737-2122\nåšå¤šåº—', parking: 'æ³Šå°é¢æ²³é‚Šæ˜¥å‰å…¬åœ’è·¯Coin Parking', dadAction: 'é¤å»³åœ¨ 2 æ¨“ï¼Œæœ‰é›»æ¢¯ã€‚', transportType: 'car', location: 'å­£æ¨‚ åšå¤šåº—', travelTime: '1.8km (10åˆ†é˜)' },
                            { id: 52, time: '14:00', title: 'LaLaport ç¦å²¡', category: 'shopping', desc: 'Tel: 092-707-9820\næ³Š South Entrance', parking: 'é§›å…¥ South Parking (å—åœè»Šå ´)', dadAction: '1. è»Šæ³Š South Entrance\n2. æµ 1F æ˜Ÿä¹ƒå’–å•¡åº—/Godiva\n3. çˆ¸çˆ¸åä½ï¼Œå¥³äººå»æƒè²¨', transportType: 'car', location: 'LaLaport Fukuoka', travelTime: '10.7km (20åˆ†é˜)' },
                            { id: 53, time: '18:30', title: 'æ™šé¤: ä¸€è˜­ å¤©ç¥è¥¿é€šã‚Š', category: 'food', desc: 'Tel: 092-713-6631\né•·æ–¹å½¢ç¢— (é‡œé†¬æ±)', parking: 'æ³Šå¤©ç¥åœ°ä¸‹è¡—åœè»Šå ´æˆ–é™„è¿‘ Times', dadAction: 'çˆ¸çˆ¸åš´ç¦é£²æ¹¯ï¼', transportType: 'car', location: 'ä¸€è˜­ å¤©ç¥è¥¿é€šã‚Šåº—', travelTime: '12.1km (30åˆ†é˜)' },
                            { id: 54, time: '21:00', title: 'å›é…’åº—ä¼‘æ¯', category: 'hotel', desc: 'Hotel JAL City', transportType: 'car', location: 'Hotel JAL City Fukuoka Tenjin', travelTime: '2km (10åˆ†é˜)' }
                        ],
                        // Day 6: 4/14 å›ç¨‹
                         [
                            { id: 61, time: '10:00', title: 'è²·åŒ…: Full Full Hakata', category: 'food', desc: 'Tel: 092-292-7838\næ˜å¤ªå­æ³•åŒ…', dadAction: 'é–€å£å¤§é¦¬è·¯ï¼Œçˆ¸çˆ¸å§‘ä¸ˆç•™è»Šä¸Šã€‚åª½åª½å§‘å§è¡è½å»è²·ã€‚\né‡‘å¥: "Cut Please" âœ‚ï¸', transportType: 'car', location: 'Full Full Hakata', travelTime: '3.2km (15åˆ†é˜)' },
                            { id: 62, time: '11:30', title: 'ç¦å²¡æ©Ÿå ´ (åœ‹å…§ç·š)', category: 'shopping', desc: 'Tel: 092-621-6059\næ³Šå¥½è»Šï¼Œ2F è²·åŠªåŠªé›', parking: 'é§›å…¥åœ‹å…§ç·šç«‹é«”åœè»Šå ´', dadAction: 'è²·å®Œå» 3F é£Ÿæ‹‰éºµ/ç‰›è…¸é‹ã€‚', transportType: 'car', location: 'ç¦å²¡æ©Ÿå ´ åœ‹å…§ç·š', travelTime: '4.6km (20åˆ†é˜)' },
                            { id: 63, time: '12:15', title: 'åˆé¤: ä¸€å¹¸èˆ / Oyama', category: 'food', desc: 'åœ‹å…§ç·š 3F', dadAction: 'çˆ¸çˆ¸å””å¥½é£²æ¹¯ã€‚', transportType: 'walk', location: 'ç¦å²¡æ©Ÿå ´', travelTime: 'æ­¥è¡Œ' },
                            { id: 64, time: '13:30', title: 'é‚„è»Š & å»æ©Ÿå ´', category: 'transport', desc: 'å°èˆªå»ç§Ÿè»Šå…¬å¸', dadAction: '1. æ‰€æœ‰äºº+è¡Œæè½è»Š (çˆ¸åª½åä½)\n2. å§‘ä¸ˆé©—è»Š\n3. å…¨å®¶æ­ Shuttle å»åœ‹éš›ç·š', transportType: 'car', location: 'ç¦å²¡æ©Ÿå ´', travelTime: '3.6km (10åˆ†é˜)' },
                            { id: 65, time: '14:30', title: 'Check-in (CX589)', category: 'flight', desc: 'åŒåœ°å‹¤è¬›: "Wheelchair Assistance Please"', dadAction: 'ç”±è·å“¡æ¨çˆ¸çˆ¸å»é–˜å£ï¼ğŸ¥°', transportType: 'walk', location: 'ç¦å²¡æ©Ÿå ´ åœ‹éš›ç·š', travelTime: 'æ¥é§è»Š' }
                        ]
                    ],

                    shoppingList: [],
                    expenses: [],

                    newItem: { title: '', time: '12:00', category: 'sightseeing', desc: '', location: '', transportType: 'car', travelTime: '', dadAction: '', parking: '' },
                    newShopping: { name: '', image: null },
                    newExpense: { name: '', amount: '', category: 'food', date: '', payment: 'ç¾é‡‘' }
                }
            },
            computed: {
                currentDayItinerary() { return this.itineraryData[this.selectedDayIndex] || []; },
                totalExpenses() { return this.expenses.reduce((sum, item) => sum + parseInt(item.amount || 0), 0); }
            },
            watch: {
                selectedDayIndex() { this.fetchWeather(); }
            },
            mounted() {
                this.fetchWeather();
                const savedShopping = localStorage.getItem('shoppingList_kyushu');
                if (savedShopping) this.shoppingList = JSON.parse(savedShopping);
                const savedExpenses = localStorage.getItem('expenses_kyushu');
                if (savedExpenses) this.expenses = JSON.parse(savedExpenses);
            },
            methods: {
                fetchWeather() {
                    let cityQuery = 'Fukuoka,JP';
                    let cityName = 'ç¦å²¡, æ—¥æœ¬';
                    if (this.selectedDayIndex === 0 || this.selectedDayIndex === 1) { cityQuery = 'Beppu,JP'; cityName = 'åˆ¥åºœ, æ—¥æœ¬'; } 
                    else if (this.selectedDayIndex === 2) { cityQuery = 'Kumamoto,JP'; cityName = 'ç†Šæœ¬, æ—¥æœ¬'; } 
                    else { cityQuery = 'Fukuoka,JP'; cityName = 'ç¦å²¡, æ—¥æœ¬'; }
                    
                    this.weather.city_name = cityName;
                    fetch(`https://api.openweathermap.org/data/2.5/weather?q=${cityQuery}&units=metric&lang=zh_tw&appid=${this.apiKey}`)
                    .then(res => res.json())
                    .then(data => {
                        this.weather.temp = Math.round(data.main.temp);
                        this.weather.feels_like = Math.round(data.main.feels_like);
                        const id = data.weather[0].id;
                        if (id === 800) this.weather.icon = 'fa-sun';
                        else if (id >= 801) this.weather.icon = 'fa-cloud';
                        else if (id >= 500) this.weather.icon = 'fa-cloud-rain';
                        else this.weather.icon = 'fa-cloud-sun';
                    })
                    .catch(() => { this.weather.temp = 20; this.weather.icon = 'fa-sun'; });
                },
                convert(type) {
                    if (type === 'jpy') this.calcHkd = (this.calcJpy * this.exchangeRate).toFixed(1);
                    else this.calcJpy = (this.calcHkd / this.exchangeRate).toFixed(0);
                },
                openMap(loc) { if(loc) window.open(`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(loc)}`, '_blank'); },
                tabClass(tab) { return this.currentTab === tab ? 'bg-onsen-600 text-white w-12 h-12 rounded-full shadow-lg flex items-center justify-center transform scale-110' : 'bg-white/90 text-onsen-600 w-10 h-10 rounded-full shadow flex items-center justify-center'; },
                getCategoryIcon(cat) { const map = { food: 'fa-utensils', transport: 'fa-car', shopping: 'fa-bag-shopping', ticket: 'fa-ticket', hotel: 'fa-bed' }; return `fa-solid ${map[cat] || 'fa-circle'}`; },
                getTransportIcon(type) { const map = { walk: 'fa-person-walking', train: 'fa-train', car: 'fa-car', bus: 'fa-bus' }; return `fa-solid ${map[type] || 'fa-arrow-right'}`; },
                itemCategoryName(cat) { const map = { sightseeing: 'æ™¯é»', food: 'ç¾é£Ÿ', shopping: 'è³¼ç‰©', transport: 'äº¤é€š', hotel: 'ä½å®¿', flight: 'èˆªç­' }; return map[cat] || 'å…¶ä»–'; },
                openAddModal() { this.showModal = true; },
                handleImageUpload(e) { const f = e.target.files[0]; if(f) { const r = new FileReader(); r.onload = (e) => this.newShopping.image = e.target.result; r.readAsDataURL(f); } },
                confirmAdd() { 
                    if (this.currentTab === 'itinerary' && this.newItem.title) {
                        this.itineraryData[this.selectedDayIndex].push({...this.newItem, id: Date.now()});
                        this.itineraryData[this.selectedDayIndex].sort((a,b) => a.time.localeCompare(b.time));
                    } else if (this.currentTab === 'shopping' && this.newShopping.name) {
                        this.shoppingList.push({...this.newShopping, id: Date.now()});
                        localStorage.setItem('shoppingList_kyushu', JSON.stringify(this.shoppingList));
                    } else if (this.currentTab === 'expenses' && this.newExpense.amount) {
                        this.expenses.push({...this.newExpense, id: Date.now()});
                        localStorage.setItem('expenses_kyushu', JSON.stringify(this.expenses));
                    }
                    this.showModal = false; 
                },
                deleteItem(id) { if(confirm('åˆªé™¤?')) this.itineraryData[this.selectedDayIndex] = this.itineraryData[this.selectedDayIndex].filter(i => i.id !== id); },
                removeShoppingItem(id) { this.shoppingList = this.shoppingList.filter(i => i.id !== id); localStorage.setItem('shoppingList_kyushu', JSON.stringify(this.shoppingList)); },
                deleteExpense(id) { if(confirm('åˆªé™¤?')) { this.expenses = this.expenses.filter(i => i.id !== id); localStorage.setItem('expenses_kyushu', JSON.stringify(this.expenses)); } },
                moveItem(idx, dir) { 
                    const list = this.itineraryData[this.selectedDayIndex];
                    const target = idx + dir;
                    if(target >= 0 && target < list.length) [list[idx], list[target]] = [list[target], list[idx]];
                }
            }
        }).mount('#app');
    </script>
</body>
</html>
